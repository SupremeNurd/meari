<link rel="stylesheet" href="assets/theme_assets/sass/page/_setting.scss">

<!doctype html>
<html lang="ko" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <title>Meari</title>

    <link rel="stylesheet" href="assets/vendor_assets/css/bootstrap/bootstrap.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/daterangepicker.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/footable.standalone.min.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/fullcalendar@5.2.0.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/jquery-jvectormap-2.0.5.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/jquery.mCustomScrollbar.min.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/leaflet.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/line-awesome.min.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/magnific-popup.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/MarkerCluster.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/MarkerCluster.Default.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/select2.min.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/slick.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/star-rating-svg.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/trumbowyg.min.css">
    <link rel="stylesheet" href="assets/vendor_assets/css/wickedpicker.min.css">
    <link rel="stylesheet" href="style.css">

<!--    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon.png">-->

    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.8/css/line.css">
</head>

<body class="layout-light side-menu">

<header class="header-top">
    <nav class="navbar navbar-light">
        <div class="navbar-left">
            <div class="logo-area">
                <a class="navbar-brand" href="index.html">
                    <img class="dark" src="/img/meari_bi_02.png" alt="logo">
                    <img class="light" src="/img/meari_bi_02.png" alt="logo">
                </a>
<!--                <a href="#" class="sidebar-toggle">-->
<!--                    <img class="svg" src="img/svg/align-center-alt.svg" alt="img">-->
<!--                </a>-->
            </div>
        </div>

        <div class="header-main-title-group">
            <span class="header-main-title">타이틀</span>
            <span class="header-main-title-ip">(192.168.0.1)</span>
        </div>

        <div class="navbar-right">

<!--            추후 필요할 수 있어 주석처리-->
<!--            <ul class="navbar-right__menu">-->
<!--                &lt;!&ndash;노티 기능&ndash;&gt;-->
<!--                <li class="nav-notification">-->
<!--                    <div class="dropdown-custom">-->
<!--                        <a href="javascript:;" class="nav-item-toggle icon-active">-->
<!--                            <img class="svg" src="img/svg/alarm.svg" alt="img">-->
<!--                        </a>-->
<!--                        <div class="dropdown-parent-wrapper">-->
<!--                            <div class="dropdown-wrapper">-->
<!--                                <h2 class="dropdown-wrapper__title">-->
<!--                                    메세지알림-->
<!--                                    <span class="badge-circle badge-warning ms-1">4</span>-->
<!--                                </h2>-->
<!--                                <ul>-->
<!--                                    <li class="nav-notification__single nav-notification__single&#45;&#45;unread d-flex flex-wrap">-->

<!--                                        <div class="nav-notification__details">-->
<!--                                            <p>-->
<!--                                                <a href="" class="subject stretched-link text-truncate" style="max-width: 180px;">현장B</a>-->
<!--                                                <span>메세지 도착</span>-->
<!--                                            </p>-->
<!--                                            <p>-->
<!--                                                <span class="time-posted">5 시간전</span>-->
<!--                                            </p>-->
<!--                                        </div>-->
<!--                                    </li>-->
<!--                                    <li class="nav-notification__single nav-notification__single&#45;&#45;unread d-flex flex-wrap">-->
<!--                                        <div class="nav-notification__details">-->
<!--                                            <p>-->
<!--                                                <a href="" class="subject stretched-link text-truncate" style="max-width: 180px;">현장B</a>-->
<!--                                                <span>메세지 도착</span>-->
<!--                                            </p>-->
<!--                                            <p>-->
<!--                                                <span class="time-posted">5 시간전</span>-->
<!--                                            </p>-->
<!--                                        </div>-->
<!--                                    </li>-->
<!--                                    <li class="nav-notification__single nav-notification__single&#45;&#45;unread d-flex flex-wrap">-->
<!--                                        <div class="nav-notification__details">-->
<!--                                            <p>-->
<!--                                                <a href="" class="subject stretched-link text-truncate" style="max-width: 180px;">현장C</a>-->
<!--                                                <span>메세지 도착</span>-->
<!--                                            </p>-->
<!--                                            <p>-->
<!--                                                <span class="time-posted">5 시간전</span>-->
<!--                                            </p>-->
<!--                                        </div>-->
<!--                                    </li>-->
<!--                                    <li class="nav-notification__single nav-notification__single d-flex flex-wrap">-->
<!--&lt;!&ndash;                                        <div class="nav-notification__type nav-notification__type&#45;&#45;info">&ndash;&gt;-->
<!--&lt;!&ndash;                                        </div>&ndash;&gt;-->
<!--                                        <div class="nav-notification__details">-->
<!--                                            <p>-->
<!--                                                <a href="" class="subject stretched-link text-truncate" style="max-width: 180px;">현장D</a>-->
<!--                                                <span>메세지 도착</span>-->
<!--                                            </p>-->
<!--                                            <p>-->
<!--                                                <span class="time-posted">5 시간전</span>-->
<!--                                            </p>-->
<!--                                        </div>-->
<!--                                    </li>-->
<!--                                    <li class="nav-notification__single nav-notification__single d-flex flex-wrap">-->
<!--                                        <div class="nav-notification__details">-->
<!--                                            <p>-->
<!--                                                <a href="" class="subject stretched-link text-truncate" style="max-width: 180px;">현장D</a>-->
<!--                                                <span>메세지 도착</span>-->
<!--                                            </p>-->
<!--                                            <p>-->
<!--                                                <span class="time-posted">5 시간전</span>-->
<!--                                            </p>-->
<!--                                        </div>-->
<!--                                    </li>-->
<!--                                </ul>-->
<!--                                <a href="" class="dropdown-wrapper__more">모든 메세지 보기</a>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </li>-->

<!--                &lt;!&ndash;설정 기능&ndash;&gt;-->
<!--                <li class="nav-settings">-->
<!--                    <div class="dropdown-custom">-->
<!--                        <a href="javascript:;" class="nav-item-toggle">-->
<!--                            <img src="img/setting.png" alt="setting">-->
<!--                        </a>-->
<!--                    </div>-->
<!--                </li>-->

<!--                &lt;!&ndash;프로필 기능&ndash;&gt;-->
<!--                <li class="nav-author">-->
<!--                    <div class="dropdown-custom">-->
<!--                        <a href="javascript:;" class="nav-item-toggle">-->
<!--                            <img src="img/author-nav.jpg" alt="" class="rounded-circle">-->
<!--                            <span class="nav-item__title">-->
<!--                                현장A-->
<!--                                <i class="las la-angle-down nav-item__arrow"></i>-->
<!--                            </span>-->
<!--                        </a>-->
<!--                        <div class="dropdown-parent-wrapper">-->
<!--                            <div class="dropdown-wrapper">-->
<!--                                <div class="nav-author__info">-->
<!--                                    <div class="author-img">-->
<!--                                        <img src="img/author-nav.jpg" alt="" class="rounded-circle">-->
<!--                                    </div>-->
<!--                                    <div>-->
<!--                                        <h6>현장A</h6>-->
<!--                                        <span>현장기기</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="nav-author__options">-->
<!--                                    <ul>-->
<!--                                        <li>-->
<!--                                            <a href="">-->
<!--                                                <i class="uil uil-user"></i>-->
<!--                                                Profile-->
<!--                                            </a>-->
<!--                                        </li>-->
<!--                                        <li>-->
<!--                                            <a href="">-->
<!--                                                <i class="uil uil-setting"></i>-->
<!--                                                Settings-->
<!--                                            </a>-->
<!--                                        </li>-->
<!--                                        <li>-->
<!--                                            <a href="">-->
<!--                                                <i class="uil uil-key-skeleton"></i>-->
<!--                                                Billing-->
<!--                                            </a>-->
<!--                                        </li>-->
<!--                                        <li>-->
<!--                                            <a href="">-->
<!--                                                <i class="uil uil-users-alt"></i>-->
<!--                                                Activity-->
<!--                                            </a>-->
<!--                                        </li>-->
<!--                                    </ul>-->
<!--&lt;!&ndash;                                    <a href="" class="nav-author__signout">&ndash;&gt;-->
<!--&lt;!&ndash;                                        <i class="uil uil-sign-out-alt"></i> &ndash;&gt;-->
<!--&lt;!&ndash;                                        Sign Out&ndash;&gt;-->
<!--&lt;!&ndash;                                    </a>&ndash;&gt;-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            &lt;!&ndash; ends: .dropdown-wrapper &ndash;&gt;-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </li>-->
<!--            </ul>-->

            <!-- 디바이스 상태 -->
            <ul class="navbar-device-info">
                <li class="device-info-time">오후 1:39분</li>
                <li class="device-info-icon">
                    <i class="fas fa-wifi"></i>
                </li>
                <li class="device-info-icon">
                    <i class="fas fa-signal"></i>
                </li>
                <li class="device-info-battery">
                    <i class="fas fa-battery-three-quarters"></i>
                    <span class="battery-level">70%</span>
                </li>
            </ul>
        </div>

    </nav>
</header>

<main class="setting-main-content">

    <div class="sidebar-wrapper">
    <div class="sidebar sidebar-collapse" id="sidebar">
        <div class="sidebar__menu-group">
            <ul class="sidebar_nav">
                <li class="sidebar-item">
                    <a href="index.html" class="sidebar-link">
                        <span class="sidebar-icon fas fa-sitemap"></span>
                        <span class="sidebar-title">대시보드</span>
                    </a>
                </li>

                <li class="sidebar-item">
                    <a href="rescue.html" class="sidebar-link">
                        <span class="sidebar-icon fas fa-chart-bar"></span>
                        <span class="sidebar-title">구조현황</span>
                    </a>
                </li>

                <li class="sidebar-item">
                    <a href="analyze.html" class="sidebar-link">
                        <span class="sidebar-icon fas fa-chart-pie"></span>
                        <span class="sidebar-title">분석</span>
                    </a>
                </li>

                <li class="sidebar-item">
                    <a href="broadcast.html" class="sidebar-link">
                        <span class="sidebar-icon fas fa-bullhorn"></span>
                        <span class="sidebar-title">방송</span>
                    </a>
                </li>

                <li class="sidebar-item">
                    <a href="setting.html" class="sidebar-link">
                        <span class="sidebar-icon fas fa-cog"></span>
                        <span class="sidebar-title">설정</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // ===== 초기 로딩 시 현재 페이지 활성화 처리 =====
        const currentPath = window.location.pathname;
        const currentPage = currentPath.split('/').pop() || 'index.html';
        const headerTitleElement = document.querySelector('.header-main-title');
        const sidebarLinks = document.querySelectorAll('.sidebar_nav .sidebar-link');

        // 사이드바 링크들을 순회하며 현재 페이지와 일치하는 링크 찾기
        sidebarLinks.forEach(link => {
            const linkPage = link.getAttribute('href').split('/').pop();
            if (currentPage === linkPage) {
                // 일치하는 링크에 active 클래스 추가
                link.classList.add('active');

                // 헤더 타이틀을 현재 페이지 메뉴명으로 변경
                const activeMenuTitle = link.querySelector('.sidebar-title')?.textContent;
                if (headerTitleElement && activeMenuTitle) {
                    headerTitleElement.textContent = activeMenuTitle;
                }

                // 부모 메뉴가 있으면 열기
                const parentLi = link.closest('li.has-child');
                if (parentLi) {
                    parentLi.classList.add('open');
                }
            }
        });

        // ===== SPA 네비게이션 로직 =====
        (function () {
            // 상수 정의
            const CONTENT_SELECTOR = '#app-content';
            const LINK_SELECTOR = '.sidebar_nav .sidebar-link';
            const headerTitleElement = document.querySelector('.header-main-title');

            // URL 기반으로 사이드바 active 상태 설정
            function setActiveByUrl(url) {
                const urlPath = new URL(url, location.origin).pathname.split('/').pop() || 'index.html';
                document.querySelectorAll(LINK_SELECTOR).forEach(a => {
                    const page = a.getAttribute('href').split('/').pop();
                    a.classList.toggle('active', page === urlPath);
                });
            }

            // 현재 active 링크의 타이틀로 헤더 업데이트
            function setHeaderTitleByActive() {
                const active = document.querySelector(LINK_SELECTOR + '.active');
                const title = active?.querySelector('.sidebar-title')?.textContent?.trim();
                if (headerTitleElement && title) headerTitleElement.textContent = title;
            }

            // 새로운 페이지의 HTML을 가져와서 메인 콘텐츠 추출
            async function fetchMain(url) {
                const res = await fetch(url, { credentials: 'same-origin' });
                if (!res.ok) throw new Error('페이지 로드 실패: ' + url);
                const html = await res.text();

                // HTML 문자열을 DOM으로 파싱
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');

                // 새 페이지에서 메인 콘텐츠 영역 추출
                const newMain = doc.querySelector(CONTENT_SELECTOR);
                if (!newMain) throw new Error(`선택자 ${CONTENT_SELECTOR}를 ${url}에서 찾을 수 없음`);

                // 브라우저 탭 타이틀 업데이트
                const newTitle = doc.querySelector('title')?.textContent;
                if (newTitle) document.title = newTitle;

                return newMain;
            }

            // Bootstrap 컴포넌트 완전 파괴 (페이지 전환 시 중요)
            function destroyBootstrapComponents(container) {
                try {
                    // 1. 모달(Modal) 제거
                    const modals = container.querySelectorAll('.modal');
                    modals.forEach(modal => {
                        const instance = bootstrap.Modal.getInstance(modal);
                        if (instance) {
                            try {
                                instance.hide();
                                setTimeout(() => {
                                    if (instance) instance.dispose();
                                }, 50);
                            } catch (e) {
                                console.warn('모달 제거 오류:', e);
                            }
                        }
                    });

                    // 2. 모달 백드롭(어두운 배경) 제거
                    document.querySelectorAll('.modal-backdrop').forEach(backdrop => {
                        backdrop.remove();
                    });

                    // 3. 드롭다운(Dropdown) 제거
                    const dropdowns = container.querySelectorAll('[data-bs-toggle="dropdown"]');
                    dropdowns.forEach(dropdown => {
                        const instance = bootstrap.Dropdown.getInstance(dropdown);
                        if (instance) {
                            try {
                                instance.dispose();
                            } catch (e) {
                                console.warn('드롭다운 제거 오류:', e);
                            }
                        }
                    });

                    // 4. 콜랩스(Collapse) 제거
                    const collapses = container.querySelectorAll('.collapse');
                    collapses.forEach(collapse => {
                        const instance = bootstrap.Collapse.getInstance(collapse);
                        if (instance) {
                            try {
                                instance.dispose();
                            } catch (e) {
                                console.warn('콜랩스 제거 오류:', e);
                            }
                        }
                    });

                    // 5. 툴팁(Tooltip) 제거
                    const tooltips = container.querySelectorAll('[data-bs-toggle="tooltip"]');
                    tooltips.forEach(tooltip => {
                        const instance = bootstrap.Tooltip.getInstance(tooltip);
                        if (instance) {
                            try {
                                instance.dispose();
                            } catch (e) {
                                console.warn('툴팁 제거 오류:', e);
                            }
                        }
                    });

                    // 6. 팝오버(Popover) 제거
                    const popovers = container.querySelectorAll('[data-bs-toggle="popover"]');
                    popovers.forEach(popover => {
                        const instance = bootstrap.Popover.getInstance(popover);
                        if (instance) {
                            try {
                                instance.dispose();
                            } catch (e) {
                                console.warn('팝오버 제거 오류:', e);
                            }
                        }
                    });

                    // 7. body 태그의 모달 관련 클래스 및 스타일 제거
                    document.body.classList.remove('modal-open');
                    document.body.style.overflow = '';
                    document.body.style.paddingRight = '';
                    document.body.removeAttribute('data-bs-overflow');
                    document.body.removeAttribute('data-bs-padding-right');
                } catch (error) {
                    console.error('Bootstrap 컴포넌트 제거 중 오류 발생:', error);
                }
            }

            // 이전 페이지 정리 (페이지 전환 전 실행)
            function cleanupPreviousPage(container) {
                // Bootstrap 컴포넌트 파괴
                destroyBootstrapComponents(container);

                // 각 페이지별 cleanup 이벤트 발생 (페이지별 스크립트에서 수신 가능)
                const cleanupEvent = new CustomEvent('page:cleanup');
                container.dispatchEvent(cleanupEvent);

                // 기존 스크립트 태그 제거 (이벤트 리스너 정리 목적)
                const oldScripts = container.querySelectorAll('script');
                oldScripts.forEach(script => script.remove());
            }

            // 새 페이지의 스크립트 재실행
            function reexecuteScripts(scopeEl) {
                const scripts = [...scopeEl.querySelectorAll('script')];
                scripts.forEach(old => {
                    try {
                        // 새 script 태그 생성
                        const s = document.createElement('script');

                        // 외부 스크립트 속성 복사
                        if (old.src) {
                            s.src = old.src;
                        }
                        if (old.type) s.type = old.type;
                        if (old.noModule) s.noModule = true;
                        if (old.defer) s.defer = true;
                        if (old.async) s.async = true;

                        // 인라인 스크립트 처리 (변수 충돌 방지를 위해 IIFE로 감싸기)
                        if (old.textContent && !old.src) {
                            const content = old.textContent.trim();
                            // 이미 IIFE(즉시실행함수)로 감싸져 있는지 확인
                            if (content.startsWith('(function()') || content.startsWith('(()') || content.startsWith('!function')) {
                                s.textContent = old.textContent;
                            } else {
                                // IIFE로 감싸서 스코프 격리
                                s.textContent = `(function(){\n${old.textContent}\n})();`;
                            }
                        } else {
                            s.textContent = old.textContent;
                        }

                        // 기존 스크립트 제거 후 새 스크립트 추가 (재실행 트리거)
                        old.remove();
                        scopeEl.appendChild(s);
                    } catch (error) {
                        console.warn('⚠️ 스크립트 실행 오류 (무시됨):', error.message);
                        // 에러가 발생해도 다음 스크립트는 계속 실행
                    }
                });
            }

            // 페이지 네비게이션 (SPA의 핵심 함수)
            async function navigate(url, { push = true } = {}) {
                const container = document.querySelector(CONTENT_SELECTOR);
                if (!container) return console.error('메인 컨테이너를 찾을 수 없음:', CONTENT_SELECTOR);

                // 로딩 중 표시
                container.setAttribute('aria-busy', 'true');

                try {
                    // 1. 새 페이지 HTML 가져오기
                    const newMainElement = await fetchMain(url);

                    // 2. 이전 페이지 정리 (Bootstrap 컴포넌트 제거 등)
                    cleanupPreviousPage(container);

                    // 3. Bootstrap 정리 완료 대기
                    await new Promise(resolve => setTimeout(resolve, 50));

                    // 4. DOM 내용물 교체
                    container.innerHTML = newMainElement.innerHTML;

                    // 5. 브라우저 히스토리에 URL 추가 (뒤로가기 지원)
                    if (push) history.pushState({ url }, '', url);

                    // 6. 사이드바 active 상태 및 헤더 타이틀 업데이트
                    setActiveByUrl(url);
                    setHeaderTitleByActive();

                    // 7. DOM 렌더링 및 라이브러리 로딩 완료 대기 후 스크립트 실행
                    await new Promise(resolve => setTimeout(resolve, 150));
                    reexecuteScripts(container);

                    // 8. 페이지 최상단으로 스크롤
                    window.scrollTo({ top: 0, behavior: 'instant' });
                } catch (e) {
                    // 오류 발생 시 일반 페이지 이동으로 폴백
                    console.error('네비게이션 오류:', e);
                    location.href = url;
                } finally {
                    // 로딩 상태 제거
                    container.removeAttribute('aria-busy');
                }
            }

            // 사이드바 링크 클릭 이벤트 가로채기 (SPA 동작 활성화)
            function interceptSidebarLinks() {
                document.addEventListener('click', (e) => {
                    const a = e.target.closest(LINK_SELECTOR);
                    if (!a) return; // 사이드바 링크가 아니면 무시

                    // 새 탭으로 열기나 중클릭은 기본 동작 유지
                    if (e.metaKey || e.ctrlKey || e.shiftKey || e.button === 1) return;

                    const href = a.getAttribute('href');
                    // 외부 링크는 기본 동작 유지
                    if (!href || href.startsWith('http')) return;

                    // 기본 동작 취소하고 SPA 네비게이션 실행
                    e.preventDefault();
                    navigate(href, { push: true });
                });
            }

            // 브라우저 뒤로가기/앞으로가기 버튼 지원
            window.addEventListener('popstate', (e) => {
                const url = e.state?.url || location.href;
                navigate(url, { push: false }); // 히스토리에 추가하지 않고 이동
            });

            // 초기화: 현재 페이지 활성화 및 링크 인터셉션 시작
            setActiveByUrl(location.href);
            setHeaderTitleByActive();
            interceptSidebarLinks();
        })();
    });
</script>

    <div class="setting-container" id="app-content">
        <section class="setting-section-list">
            <div class="card card-default card-md mb-4">
                <div class="card-body">
                    <div class="tab-wrapper">
                        <div class="dm-tab tab-horizontal">

                            <!--탭 타이틀-->
                            <ul class="nav nav-tabs vertical-tabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="tab-v-1-tab" data-bs-toggle="tab" href="#tab-v-1" role="tab" aria-selected="true">
                                        센서관리
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="tab-v-2-tab" data-bs-toggle="tab" href="#tab-v-2" role="tab" aria-selected="false">
                                        기기관리
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="tab-v-3-tab" data-bs-toggle="tab" href="#tab-v-3" role="tab" aria-selected="false">
                                        방송데이터 관리
                                    </a>
                                </li>
                            </ul>

                            <div class="tab-content">

                                <!-- 센서관리 탭 데이터-->
                                <div class="tab-pane fade show active" id="tab-v-1" role="tabpanel" aria-labelledby="tab-v-1-tab">
                                    <div class="setting-sensor-item">
                                        <div class="d-flex align-items-center">
                                            <div class="sensor-icon-wrapper">
                                                <div class="sensor-icon active">
                                                    <img src="img/sensor_icon/portable_icon.png" alt="센서아이콘" class="sensor-custom-icon">
                                                </div>
                                            </div>
                                            <div class="">
                                                <div class="sensor-details">
                                                    <span class="sensor-status active">연결양호</span>
                                                    <span class="sensor-name">휴대용 센서 1호기</span>
                                                </div>

                                            </div>
                                            <div class="setting-sensor-icons">
                                                <i class="fas fa-signal"></i>
                                                <i class="fas fa-wifi"></i>
                                                <i class="fas fa-battery-three-quarters"></i>
                                                <span>75%</span>
                                            </div>
                                        </div>
                                        <div class="setting-btn-group">
                                            <button type="button" class="pairing-btn" data-bs-toggle="modal" data-bs-target="#pairingModal">
                                                <i class="fas fa-link me-1"></i>
                                                페어링
                                            </button>
                                            <button type="button" class="pairing-btn">
                                                펌웨어 업데이트
                                            </button>
                                        </div>
                                    </div>

                                    <div class="setting-sensor-item">
                                        <div class="d-flex align-items-center">
                                            <div class="sensor-icon-wrapper">
                                                <div class="sensor-icon active">
                                                    <img src="img/sensor_icon/portable_icon.png" alt="센서아이콘" class="sensor-custom-icon">
                                                </div>
                                            </div>
                                            <div class="">
                                                <div class="sensor-details">
                                                    <span class="sensor-status active">연결양호</span>
                                                    <span class="sensor-name">휴대용 센서 2호기</span>
                                                </div>

                                            </div>
                                            <div class="setting-sensor-icons">
                                                <i class="fas fa-signal"></i>
                                                <i class="fas fa-wifi"></i>
                                                <i class="fas fa-battery-three-quarters"></i>
                                                <span>75%</span>
                                            </div>
                                        </div>
                                        <div class="setting-btn-group">
                                            <button type="button" class="pairing-btn" data-bs-toggle="modal" data-bs-target="#pairingModal">
                                                <i class="fas fa-link me-1"></i>
                                                페어링
                                            </button>
                                            <button type="button" class="pairing-btn">
                                                펌웨어 업데이트
                                            </button>
                                        </div>
                                    </div>

                                    <div class="setting-sensor-item">
                                        <div class="d-flex align-items-center">
                                            <div class="sensor-icon-wrapper">
                                                <div class="sensor-icon active">
                                                    <img src="img/sensor_icon/portable_icon.png" alt="센서아이콘" class="sensor-custom-icon">
                                                </div>
                                            </div>
                                            <div class="">
                                                <div class="sensor-details">
                                                    <span class="sensor-status active">연결양호</span>
                                                    <span class="sensor-name">휴대용 센서 3호기</span>
                                                </div>

                                            </div>
                                            <div class="setting-sensor-icons">
                                                <i class="fas fa-signal"></i>
                                                <i class="fas fa-wifi"></i>
                                                <i class="fas fa-battery-three-quarters"></i>
                                                <span>75%</span>
                                            </div>
                                        </div>
                                        <div class="setting-btn-group">
                                            <button type="button" class="pairing-btn" data-bs-toggle="modal" data-bs-target="#pairingModal">
                                                <i class="fas fa-link me-1"></i>
                                                페어링
                                            </button>
                                            <button type="button" class="pairing-btn">
                                                펌웨어 업데이트
                                            </button>
                                        </div>
                                    </div>

                                    <div class="setting-sensor-item">
                                        <div class="d-flex align-items-center">
                                            <div class="sensor-icon-wrapper">
                                                <div class="sensor-icon active">
                                                    <img src="img/sensor_icon/portable_icon.png" alt="센서아이콘" class="sensor-custom-icon">
                                                </div>
                                            </div>
                                            <div class="">
                                                <div class="sensor-details">
                                                    <span class="sensor-status active">연결양호</span>
                                                    <span class="sensor-name">휴대용 센서 4호기</span>
                                                </div>

                                            </div>
                                            <div class="setting-sensor-icons">
                                                <i class="fas fa-signal"></i>
                                                <i class="fas fa-wifi"></i>
                                                <i class="fas fa-battery-three-quarters"></i>
                                                <span>75%</span>
                                            </div>
                                        </div>
                                        <div class="setting-btn-group">
                                            <button type="button" class="pairing-btn" data-bs-toggle="modal" data-bs-target="#pairingModal">
                                                <i class="fas fa-link me-1"></i>
                                                페어링
                                            </button>
                                            <button type="button" class="pairing-btn">
                                                펌웨어 업데이트
                                            </button>
                                        </div>
                                    </div>

                                    <div class="setting-sensor-item">
                                        <div class="d-flex align-items-center">
                                            <div class="sensor-icon-wrapper">
                                                <div class="sensor-icon active">
                                                    <img src="img/sensor_icon/injection_icon.png" alt="센서아이콘" class="sensor-custom-icon">
                                                </div>
                                            </div>
                                            <div class="">
                                                <div class="sensor-details">
                                                    <span class="sensor-status active">연결양호</span>
                                                    <span class="sensor-name">투입형 센서 1호기</span>
                                                </div>

                                            </div>
                                            <div class="setting-sensor-icons">
                                                <i class="fas fa-signal"></i>
                                                <i class="fas fa-wifi"></i>
                                                <i class="fas fa-battery-three-quarters"></i>
                                                <span>75%</span>
                                            </div>
                                        </div>
                                        <div class="setting-btn-group">
                                            <button type="button" class="pairing-btn" data-bs-toggle="modal" data-bs-target="#pairingModal">
                                                <i class="fas fa-link me-1"></i>
                                                페어링
                                            </button>
                                            <button type="button" class="pairing-btn">
                                                펌웨어 업데이트
                                            </button>
                                        </div>
                                    </div>

                                    <div class="setting-sensor-item">
                                        <div class="d-flex align-items-center">
                                            <div class="sensor-icon-wrapper">
                                                <div class="sensor-icon active">
                                                    <img src="img/sensor_icon/injection_icon.png" alt="센서아이콘" class="sensor-custom-icon">
                                                </div>
                                            </div>
                                            <div class="">
                                                <div class="sensor-details">
                                                    <span class="sensor-status active">연결양호</span>
                                                    <span class="sensor-name">투입형 센서 2호기</span>
                                                </div>

                                            </div>
                                            <div class="setting-sensor-icons">
                                                <i class="fas fa-signal"></i>
                                                <i class="fas fa-wifi"></i>
                                                <i class="fas fa-battery-three-quarters"></i>
                                                <span>75%</span>
                                            </div>
                                        </div>
                                        <div class="setting-btn-group">
                                            <button type="button" class="pairing-btn" data-bs-toggle="modal" data-bs-target="#pairingModal">
                                                <i class="fas fa-link me-1"></i>
                                                페어링
                                            </button>
                                            <button type="button" class="pairing-btn">
                                                펌웨어 업데이트
                                            </button>
                                        </div>
                                    </div>

                                    <div class="setting-sensor-item">
                                        <div class="d-flex align-items-center">
                                            <div class="sensor-icon-wrapper">
                                                <div class="sensor-icon active">
                                                    <img src="img/sensor_icon/injection_icon.png" alt="센서아이콘" class="sensor-custom-icon">
                                                </div>
                                            </div>
                                            <div class="">
                                                <div class="sensor-details">
                                                    <span class="sensor-status active">연결양호</span>
                                                    <span class="sensor-name">투입형 센서 3호기</span>
                                                </div>

                                            </div>
                                            <div class="setting-sensor-icons">
                                                <i class="fas fa-signal"></i>
                                                <i class="fas fa-wifi"></i>
                                                <i class="fas fa-battery-three-quarters"></i>
                                                <span>75%</span>
                                            </div>
                                        </div>
                                        <div class="setting-btn-group">
                                            <button type="button" class="pairing-btn" data-bs-toggle="modal" data-bs-target="#pairingModal">
                                                <i class="fas fa-link me-1"></i>
                                                페어링
                                            </button>
                                            <button type="button" class="pairing-btn">
                                                펌웨어 업데이트
                                            </button>
                                        </div>
                                    </div>

                                    <div class="setting-sensor-item">
                                        <div class="d-flex align-items-center">
                                            <div class="sensor-icon-wrapper">
                                                <div class="sensor-icon active">
                                                    <img src="img/sensor_icon/injection_icon.png" alt="센서아이콘" class="sensor-custom-icon">
                                                </div>
                                            </div>
                                            <div class="">
                                                <div class="sensor-details">
                                                    <span class="sensor-status active">연결양호</span>
                                                    <span class="sensor-name">투입형 센서 4호기</span>
                                                </div>

                                            </div>
                                            <div class="setting-sensor-icons">
                                                <i class="fas fa-signal"></i>
                                                <i class="fas fa-wifi"></i>
                                                <i class="fas fa-battery-three-quarters"></i>
                                                <span>75%</span>
                                            </div>
                                        </div>
                                        <div class="setting-btn-group">
                                            <button type="button" class="pairing-btn" data-bs-toggle="modal" data-bs-target="#pairingModal">
                                                <i class="fas fa-link me-1"></i>
                                                페어링
                                            </button>
                                            <button type="button" class="pairing-btn">
                                                펌웨어 업데이트
                                            </button>
                                        </div>
                                    </div>
                                </div>


                                <!-- 기기관리 탭 데이터-->
                                <div class="tab-pane fade" id="tab-v-2" role="tabpanel" aria-labelledby="tab-v-2-tab">
                                    <div class="device-settings-container">

                                        <section class="settings-section-card">
                                            <header class="settings-section-header">
                                                <i class="fas fa-desktop"></i>
                                                <h6>디바이스 정보</h6>
                                            </header>
                                            <div class="settings-section-body">
                                                <div class="settings-info-row">
                                                    <span class="settings-info-label">IP 주소</span>
                                                    <span class="settings-info  -value">192.168.0.1</span>
                                                </div>
                                                <div class="settings-info-row">
                                                    <span class="settings-info-label">펌웨어 버전</span>
                                                    <div class="settings-info-action">
                                                        <span class="settings-info-value">meari 0.001</span>
                                                        <button type="button" class="settings-action-btn">업데이트</button>
                                                    </div>
                                                </div>
                                                <div class="settings-info-row">
                                                    <span class="settings-info-label">현재 시간</span>
                                                    <div class="settings-info-action">
                                                        <span class="settings-info-value">오전 12:35:42</span>
                                                        <button type="button" class="settings-action-btn">시간수정</button>
                                                    </div>
                                                </div>
                                                <div class="settings-info-row">
                                                    <span class="settings-info-label">Wi-Fi</span>
                                                    <div class="settings-info-action">
                                                        <span class="settings-info-value">Meari-WiFi-001</span>
                                                        <button type="button" class="settings-action-btn">연결</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </section>

                                        <section class="settings-section-card">
                                            <header class="settings-section-header">
                                                <i class="fas fa-chart-bar"></i>
                                                <h6>리소스 정보</h6>
                                            </header>
                                            <div class="settings-section-body">
                                                <div class="settings-resource-row">
                                                    <span class="settings-resource-label">CPU 사용량</span>
                                                    <div class="settings-progress-wrapper">
                                                        <div class="settings-progress-container">
                                                            <div class="settings-progress-bar" style="width: 74%;"></div>
                                                        </div>
                                                        <span class="settings-progress-percent">74%</span>
                                                    </div>
                                                </div>
                                                <div class="settings-resource-row">
                                                    <span class="settings-resource-label">메모리 사용량</span>
                                                    <div class="settings-progress-wrapper">
                                                        <div class="settings-progress-container">
                                                            <div class="settings-progress-bar" style="width: 34%;"></div>
                                                        </div>
                                                        <span class="settings-progress-percent">34%</span>
                                                    </div>
                                                </div>
                                                <div class="settings-resource-row">
                                                    <span class="settings-resource-label">저장공간 사용량</span>
                                                    <div class="settings-progress-wrapper">
                                                        <div class="settings-progress-container">
                                                            <div class="settings-progress-bar" style="width: 79%;"></div>
                                                        </div>
                                                        <span class="settings-progress-percent">79%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </section>

                                        <section class="settings-section-card">
                                            <header class="settings-section-header">
                                                <i class="fas fa-user"></i>
                                                <h6>사용자 정보</h6>
                                            </header>
                                            <div class="settings-section-body">
                                                <div class="settings-info-row">
                                                    <span class="settings-info-label">접속자 정보</span>
                                                    <span class="settings-info-value">메아리</span>
                                                </div>
                                                <div class="settings-info-row">
                                                    <span class="settings-info-label">서버주소</span>
                                                    <div class="settings-info-action">
                                                        <span class="settings-info-value">192.168.0.1</span>
                                                        <button type="button" class="settings-action-btn">연결</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </section>
                                    </div>

                                </div>

                                <!-- 방송데이터 관리 탭 데이터-->
                                <div class="tab-pane fade" id="tab-v-3" role="tabpanel" aria-labelledby="tab-v-3-tab">
                                    <div class="broadcast-manage-body">
                                        <div class="broadcast-manage-list-container">

                                            <div class="broadcast-manage-item">
                                                <div>
                                                    <div class="broadcast-manage-col-time">
                                                        2025년 11월 12일 오후 1시 30분
                                                    </div>
                                                    <div class="broadcast-manage-col-duration">
                                                        <i class="fas fa-sync-alt"></i>
                                                        1분 30초
                                                    </div>
                                                </div>
                                                <div class="broadcast-manage-col-message">
                                                    <i class="fas fa-volume-down"></i>
                                                    생존자가 있으면 소리를 질러주세요.
                                                </div>
                                                <button type="button"
                                                        class="broadcast-manage-btn-edit"
                                                        data-bs-toggle="modal"
                                                        data-bs-target="#editBroadcastModal"
                                                >
                                                    수정
                                                </button>
                                            </div>

                                            <div class="broadcast-manage-item">
                                                <div>
                                                    <div class="broadcast-manage-col-time">
                                                        2025년 11월 12일 오후 1시 30분
                                                    </div>
                                                    <div class="broadcast-manage-col-duration">
                                                        <i class="fas fa-sync-alt"></i> 1분 30초
                                                    </div>
                                                </div>
                                                <div class="broadcast-manage-col-message">
                                                    <i class="fas fa-volume-down"></i> 방송이 들리면 소리를 내주세요.
                                                </div>
                                                <button type="button"
                                                        class="broadcast-manage-btn-edit"
                                                        data-bs-toggle="modal"
                                                        data-bs-target="#editBroadcastModal"
                                                >
                                                    수정
                                                </button>
                                            </div>

                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </section>

        <script>
            (function() {
                function initSettingPage() {

                    const editBroadcastModal = document.getElementById('editBroadcastModal');
                    const pairingButtons = document.querySelectorAll('.pairing-btn');

                    if (!pairingButtons || pairingButtons.length === 0) {
                        return; // setting.html이 아니면 중단
                    }

                    if (editBroadcastModal) {
                        editBroadcastModal.addEventListener('show.bs.modal', function (event) {
                            const triggerButton = event.relatedTarget;
                            const item = triggerButton.closest('.broadcast-manage-item');
                            if (item) {

                            }
                        });
                    }
                }

                /**
                 * [SPA + 새로고침 호환 래퍼 (최종 수정)]
                 */
                function checkLibrariesAndRun() {
                    if (typeof bootstrap !== 'undefined') {
                        // 라이브러리 로드 완료 (SPA 이동 시)
                        // 라우터가 150ms를 기다리므로, 여기서는 즉시 실행
                        initSettingPage();
                    } else {
                        // 2. 아직 로드 안됨 (새로고침 중...)
                        setTimeout(checkLibrariesAndRun, 50);
                    }
                }
                checkLibrariesAndRun();
            })();
        </script>

        <!-- 페어링 모달-->
        <div class="modal fade" id="pairingModal" tabindex="-1" aria-labelledby="pairingModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content pairing-modal-content">

                    <div class="pairing-modal-header">
                        <i class="fas fa-link pairing-header-icon"></i>
                        <h5 class="pairing-header-title" id="pairingModalLabel">
                            페어링
                        </h5>
                        <p class="pairing-header-subtitle">
                            페어링을 연결할 기기를 선택해주세요.
                        </p>
                    </div>

                    <div class="modal-body pairing-modal-body">
                        <div class="pairing-diagram-container">

                            <div class="pairing-node">
                                <div class="pairing-icon-wrapper">
                                    <i class="fas fa-broadcast-tower"></i>
                                </div>
                                <span class="pairing-node-label">센서</span>
                            </div>

                            <div class="pairing-dotted-line"></div>

                            <div class="pairing-node">
                                <div class="pairing-icon-wrapper">
                                    <i class="fas fa-hdd"></i>
                                </div>
                                <span class="pairing-node-label">통신단말기</span>
                                <button type="button" class="pairing-btn">
                                    연결
                                </button>
                            </div>

                            <div class="pairing-dotted-line"></div>

                            <div class="pairing-node">
                                <div class="pairing-icon-wrapper">
                                    <i class="fas fa-server"></i>
                                </div>
                                <span class="pairing-node-label">서버</span>
                                <button type="button" class="pairing-btn">
                                    연결됨
                                </button>
                            </div>

                        </div>
                    </div>

                    <div class="modal-footer pairing-modal-footer">
                        <button type="button" class="btn-pairing-cancel" data-bs-dismiss="modal">
                            취소
                        </button>
                        <button type="button" class="btn-pairing-save">
                            저장
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 방송데이터 관리 모달-->
        <div class="modal fade" id="editBroadcastModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content edit-modal-content">

                    <div class="edit-modal-header">
                        <i class="fas fa-bullhorn edit-header-icon"></i>
                        <h5 class="edit-header-title" id="editModalLabel">
                            방송데이터 수정
                        </h5>
                        <p class="edit-header-subtitle">
                            방송 데이터의 삭제 또는 고정하여 삭제방지를 설정하세요.
                        </p>
                    </div>

                    <div class="modal-body edit-modal-body">
                        <div id="edit-modal-time" class="edit-modal-line"></div>
                        <div id="edit-modal-duration" class="edit-modal-line"></div>
                        <div id="edit-modal-message" class="edit-modal-line"></div>
                    </div>

                    <div class="modal-footer edit-modal-footer">
                        <button type="button" class="btn-edit-cancel" data-bs-dismiss="modal">
                            취소
                        </button>
                        <button type="button" class="btn-edit-pin">
                            <i class="fas fa-thumbtack"></i>
                            고정
                        </button>
                        <button type="button" class="btn-edit-delete">
                            삭제
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer-wrapper">
    <div class="footer-wrapper__inside">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6">
                    <div class="footer-copyright">
                        <p>
                            <span>© 2025</span>
                            <a href="#" style="color: #404040">
                                Harsper
                            </a>
                        </p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="footer-menu text-end">
                        <ul>
                            <li>
                                <a href="#">사용법</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
</main>



</main>

<!--<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBgYKHZB_QKKLWfIRaYPCadza3nhTAbv7c"></script>-->

<script src="assets/vendor_assets/js/jquery/jquery-3.5.1.min.js"></script>
<script src="assets/vendor_assets/js/jquery/jquery-ui.js"></script>
<script src="assets/vendor_assets/js/bootstrap/popper.js"></script>
<script src="assets/vendor_assets/js/bootstrap/bootstrap.min.js"></script>
<script src="assets/vendor_assets/js/moment/moment.min.js"></script>
<script src="assets/vendor_assets/js/accordion.js"></script>
<script src="assets/vendor_assets/js/apexcharts.min.js"></script>
<script src="assets/vendor_assets/js/autoComplete.js"></script>
<script src="assets/vendor_assets/js/Chart.min.js"></script>
<script src="assets/vendor_assets/js/daterangepicker.js"></script>
<script src="assets/vendor_assets/js/drawer.js"></script>
<script src="assets/vendor_assets/js/dynamicBadge.js"></script>
<script src="assets/vendor_assets/js/dynamicCheckbox.js"></script>
<script src="assets/vendor_assets/js/footable.min.js"></script>
<script src="assets/vendor_assets/js/fullcalendar@5.2.0.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.2.0/locales/ko.js"></script>
<script src="assets/vendor_assets/js/google-chart.js"></script>
<script src="assets/vendor_assets/js/jquery-jvectormap-2.0.5.min.js"></script>
<script src="assets/vendor_assets/js/jquery-jvectormap-world-mill-en.js"></script>
<script src="assets/vendor_assets/js/jquery.countdown.min.js"></script>
<script src="assets/vendor_assets/js/jquery.filterizr.min.js"></script>
<script src="assets/vendor_assets/js/jquery.magnific-popup.min.js"></script>
<script src="assets/vendor_assets/js/jquery.peity.min.js"></script>
<script src="assets/vendor_assets/js/jquery.star-rating-svg.min.js"></script>
<script src="assets/vendor_assets/js/leaflet.js"></script>
<script src="assets/vendor_assets/js/leaflet.markercluster.js"></script>
<script src="assets/vendor_assets/js/loader.js"></script>
<script src="assets/vendor_assets/js/message.js"></script>
<script src="assets/vendor_assets/js/moment.js"></script>
<script src="assets/vendor_assets/js/muuri.min.js"></script>
<script src="assets/vendor_assets/js/notification.js"></script>
<script src="assets/vendor_assets/js/popover.js"></script>
<script src="assets/vendor_assets/js/select2.full.min.js"></script>
<script src="assets/vendor_assets/js/slick.min.js"></script>
<script src="assets/vendor_assets/js/trumbowyg.min.js"></script>
<script src="assets/vendor_assets/js/wickedpicker.min.js"></script>
<script src="assets/theme_assets/js/apexmain.js"></script>
<script src="assets/theme_assets/js/charts.js"></script>
<script src="assets/theme_assets/js/drag-drop.js"></script>
<script src="assets/theme_assets/js/footable.js"></script>
<script src="assets/theme_assets/js/full-calendar.js"></script>
<!--<script src="assets/theme_assets/js/googlemap-init.js"></script>-->
<script src="assets/theme_assets/js/icon-loader.js"></script>
<script src="assets/theme_assets/js/jvectormap-init.js"></script>
<script src="assets/theme_assets/js/leaflet-init.js"></script>
<script src="assets/theme_assets/js/main.js"></script>

</body>

</html>